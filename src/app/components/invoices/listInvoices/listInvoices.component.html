<div class="grid">
  <div class="col-12">
    <div class="card">
      <h3>List invoices</h3>
      <div class="mb-2">
        <p-button [icon]="contentVisible ? 'pi pi-times' : 'pi pi-plus'" styleClass="p-button-info p-button-rounded" (click)="addInvoice()" *ngIf="!isEditing"></p-button>
      </div>
      <div class="grid" *ngIf="contentVisible">
        <div class="col-12">
          <div class="card">
            <!-- form -->
            <form action="" method="post" [formGroup]="invoiceForm">
              <div class="grid">
                <div class="col-12" *ngIf="isEditing">
                  <b>ID: </b>{{ invoiceId }} - <b>AccID: </b>{{ idAcc }}
                </div>
                <div class="col-12" *ngIf="isEditing">
                  Remain money: {{ owned }}
                </div>
                <div class="col-12 md:col-6 lg:col-4">
                  <div>Money</div>
                  <!-- <input type="text" class="mt-1 w-full" pInputText formControlName="paidMoney" /> -->
                  <p-inputNumber inputId="integeronly" autoWidth="false" [style]="{'width':'100%'}"  formControlName="paidMoney"> </p-inputNumber>
                </div>
                <div class="col-12 md:col-6 lg:col-4">
                  <div>Delivery status</div>
                  <p-dropdown [options]="deliveryOptions" autoWidth="false" [style]="{'width':'100%'}" formControlName="deliveryStatus" optionLabel="label" optionValue="value"></p-dropdown>
                </div>
                <div class="col-12 md:col-6 lg:col-4">
                  <div>Paid status</div>
                  <p-dropdown [options]="paidOptions" formControlName="paidStatus" optionLabel="label" optionValue="value"></p-dropdown>
                </div>
                <div class="col-12 md:col-6 lg:col-4">
                  <div>Description</div>
                  <label class="font-bold mr-1">Description</label>
                  <input type="text" pInputText formControlName="description" />
                </div>
                <!-- form button -->
                <div class="col-12 flex justify-content-end">
                  <p-button
                    [label]="isEditing ? 'Update' : 'Create'"
                    class="mr-2"
                    styleClass="p-button-outlined p-button-success"
                    (click)="save()"
                  ></p-button>
                  <p-button
                    label="Cancel"
                    styleClass="p-button-outlined p-button-success"
                    (click)="cancelEditing()"
                  ></p-button>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      <!-- table -->
      <p-table [value]="invoices" dataKey="invoiceId" class="mt-1">
        <ng-template pTemplate="header">
          <tr>
            <th [ngStyle]="{'width':'200px'}">Action</th>
            <th>No.</th>
            <th>Account ID</th>
            <th>Total</th>
            <th>Paid</th>
            <th>Owned</th>
            <th>Paid Status</th>
            <th>Delivery Status</th>
            <th>Description</th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-invoice let-expanded="expanded">
          <tr>
            <td [ngStyle]="{'width':'200px'}">
              <p-button class="mr-1" icon="pi pi-pencil" styleClass="p-button-info" (click)="editRow(invoice)"></p-button>
              <p-button [icon]="expanded ? 'pi pi-eye-slash' : 'pi pi-eye'" styleClass="p-button-success" [pRowToggler]="invoice"></p-button>
            </td>
            <td>{{ invoice.invoiceId }}</td>
            <td>{{ invoice.idAcc }}</td>
            <td>{{ invoice.total }}</td>
            <td>{{ invoice.paid }}</td>
            <td>{{ invoice.owned }}</td>
            <td>
              <p-tag
                [value]="getDeliveryStatusName(invoice.deliveryStatus)"
                [severity]="getDeliveryStatusVariant(invoice)"
              ></p-tag>
            </td>
            <td>
              <p-tag
                [value]="getPaidStatusName(invoice.paidStatus)"
                [severity]="getPaidStatusVariant(invoice)"
              ></p-tag>
            </td>
            <td>{{ invoice.description }}</td>
          </tr>
        </ng-template>
        <!-- table expand -->
        <ng-template pTemplate="rowexpansion" let-invoice>
          <tr>
            <td colspan="12">
              <div class="grid">
                <div class="col-6">
                  <div class="p-3 pt-0">
                    <b>Created: </b>{{ invoice.created }}
                  </div>
                  <div class="p-3 pt-0">
                    <b>Expected Date: </b>{{ invoice.expectedDate }}
                  </div>
                  <div class="p-3 pt-0 pb-0">
                    <b>Completed Date: </b>{{ invoice.completedDate }}
                  </div>
                </div>
                <div class="col-6">
                  <div class="p-3 pt-0">
                    <b>Services: </b>{{ getServiceName(invoice.serviceId) }}
                  </div>
                  <div class="p-3 pt-0">
                    <b>Color: </b>{{ invoice.color }}
                  </div>
                  <div class="p-3 pt-0">
                    <b>Quantity: </b>{{ invoice.quantity }}
                  </div>
                </div>
              </div>
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>
